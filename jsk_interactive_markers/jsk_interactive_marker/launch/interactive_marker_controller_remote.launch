<launch>
  <arg name="REMOTE_TF" default="/tf_low_frequency"/>
  <arg name="USE_INTERACTIVE_JOINT" default="true" />
  <arg name="USE_INTERACTIVE_ENDCOORDS" default="true" />
  <arg name="ROBOT_DESCRIPTION_REMOTE" default="robot_description" />
  <arg name="LAUNCH_DYNAMIC_TF_PUBLISHER" default="true" />

  <arg name="ROBOT" default="PR2" />
  <arg name="ROBOT_ROOTFRAME" default="base_footprint" />

  <!-- joint marker -->
  <group if="$(arg USE_INTERACTIVE_JOINT)">
    <remap from="/tf" to="$(arg REMOTE_TF)"/>
    <remap from="/set_dynamic_tf" to="/dynamic_tf_publisher_remote/set_dynamic_tf"/>
    <remap from="/delete_tf" to="/dynamic_tf_publisher_remote/delete_tf"/>
    <remap from="/dissoc_tf" to="/dynamic_tf_publisher_remote/dissoc_tf"/>
    <remap from="/assoc_tf" to="/dynamic_tf_publisher_remote/assoc_tf"/>

    <node pkg="rviz" type="rviz" name="rviz_for_interactive_marker" args="-d $(find jsk_interactive_marker)/launch/atlas_joint_marker.rviz" respawn="true">
      <remap from="/robot_description" to="$(arg ROBOT_DESCRIPTION_REMOTE)"/>
    </node>
    <node pkg="jsk_interactive_marker" type="dummy_camera.py"
	  name="dummy_camera_above">
      <param name="frame_id" value="dummy_camera_above"/>
    </node>
    <node pkg="tf" type="static_transform_publisher"
	  name="dummy_camera_above_tf"
	  args="0 0 1 0 0 0 /moving_marker /dummy_camera_above 30"/>

    <include file="$(find jsk_interactive_marker)/launch/urdf_model_markers.launch">
      <arg name="LAUNCH_DYNAMIC_TF_PUBLISHER" value="$(arg LAUNCH_DYNAMIC_TF_PUBLISHER)"/>
      <arg name="models" value="$(find jsk_interactive_marker)/launch/models/PR2-real.yaml"/>
    </include>
  </group>

  <!-- hand marker -->
  <group if="$(arg USE_INTERACTIVE_ENDCOORDS)" >
    <remap from="/tf" to="$(arg REMOTE_TF)"/>
    <remap from="/set_dynamic_tf" to="/dynamic_tf_publisher_remote/set_dynamic_tf"/>
    <remap from="/dissoc_tf" to="/dynamic_tf_publisher_remote/dissoc_tf"/>
    <remap from="/delete_tf" to="/dynamic_tf_publisher_remote/delete_tf"/>
    <remap from="/assoc_tf" to="/dynamic_tf_publisher_remote/assoc_tf"/>

    <include file="$(find jsk_interactive_marker)/launch/pr2_interactive_marker.launch" />

    <node pkg="roseus" type="roseus" name="ik_controller" args="$(find jsk_interactive_marker)/euslisp/ik-controller-main.l" output="screen">
      <param name="robot" value="$(arg ROBOT)"/>
    </node>

    <!-- eus-ik-server -->
    <node pkg="roseus" type="roseus" name="pr2_ik_server"
	  args="$(find jsk_ik_server)/euslisp/ik-server-impl/pr2-ik-server.l"/>
  </group>

</launch>
